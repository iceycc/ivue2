{"version":3,"file":"vue.js","sources":["../src/observer/array.js","../src/observer/dep.js","../src/observer/index.js","../src/utils.js","../src/observer/scheduler.js","../src/observer/watcher.js","../src/state.js","../src/compiler/parse.js","../src/compiler/generate.js","../src/compiler/index.js","../src/vdom/patch.js","../src/lifecycle.js","../src/init.js","../src/vdom/index.js","../src/render.js","../src/global-api/index.js","../src/index.js"],"sourcesContent":["let oldArrayProtoMethod = Array.prototype;\n// 不能直接改写数组的原有数组\nexport let arrayMethods = Object.create(Array.prototype)\nlet methods = [ // 这七个会改写原数组\n    'push',\n    'pop',\n    'shift',\n    'unshift',\n    'sort',\n    'splice',\n    'sort'\n]\n// 根据索引改值还是监听不到。\nmethods.forEach(_method => {\n    // aop\n    arrayMethods[_method] = function (...args) {\n        console.log('数组变化了')\n        let result = oldArrayProtoMethod[_method].call(this, ...args);\n        // 有可能用户新增的数据是对象格式时\n        let inserted;\n        let __obj__ = this.__ob__\n        switch (_method) {\n            case 'push':\n            case 'unshift':\n                inserted = args\n                break;\n            case 'splice':\n                inserted = args.slice(2);\n        }\n        if (inserted) {\n            // observeArray\n            __obj__.observeArray(inserted) // 谁调方法this就指向谁\n\n        }\n        __obj__.dep.notify() // 修改数组时触发通知更新watcher\n        return result;\n    }\n})\n","// 全局一个Dep属性\nlet id = 0\n\nclass Dep {\n    constructor() {\n        this.id = id++\n        this.subs = [] // 属性要记住这个watcher\n    }\n\n    depend() {\n        // 让watcher记住这个dep\n        Dep.target.addDep(this) // Dep.target = watcher, 让watcher记住dep\n    }\n    addSub(watcher){ //\n        this.subs.push(watcher)\n    }\n    notify(){\n        this.subs.forEach(watcher=>watcher.update())\n    }\n}\n\nDep.target = null;\n\nexport function pushTarget(watcher) {\n    Dep.target = watcher\n}\n\nexport function popTarget() {\n    Dep.target = null\n}\n\nexport default Dep\n","import {arrayMethods} from \"./array\";\nimport Dep from \"./dep\";\n\nclass Observer {\n    constructor(value) { // 重新定义\n        // value.__ob__ = this; // 这样会死循环，用下面的\n        this.dep = new Dep(); // 给数组本身或者对象本身增加一个一个dep属性\n        Object.defineProperty(value, '__ob__', {\n            value: this,\n            enumerable: false, // 可点数的,可列举的\n            configurable: false // 可配置的\n        })\n        // value数组或者对象\n        if (Array.isArray(value)) {\n            // 数组不用defineProperty\n            // push shift reverse sort 等方法需要重写\n            // value.__proto__ = arrayMethods\n            Object.setPrototypeOf(value, arrayMethods);\n            this.observeArray(value) // 数组原有的值会\n        } else {\n            this.walk(value)\n        }\n    }\n\n    observeArray(value) {\n        for (let item of value) {\n            observer(item)\n        }\n    }\n\n    walk(data) {\n        // 将对象所有key 重新用defineProperty定义成响应式\n        Object.keys(data).forEach(key => {\n            defineReactive(data, key, data[key])\n        })\n    }\n}\n\nfunction dependArray(value) {\n    // 让外层、里层都是一个watcher\n    // 处理多维数组\n    for (let item of value) {\n        item.__ob__ && item.__ob__.dep.depend()\n        if (Array.isArray(item)) { // 递归继续进行依赖收集\n            dependArray(item)\n        }\n    }\n}\n\nexport function defineReactive(data, key, value) {// vue2数据嵌套不可以过深，过深浪费性能\n    let childObj = observer(value); // 对值递归劫持, 返回的数组或者时对象，会有一个dep属性\n    let dep = new Dep() // 每次都会给属性创建一个dep\n    Object.defineProperty(data, key, { // 需要给每个属性增加Dep\n        get() {\n            if (Dep.target) {\n                dep.depend(); // 让这个属性自己的dep记住这个watcher，也让watcher记住这个dep\n                if (childObj) {// 可能数组也可能是对象，一般是数组，只有在$set给对象新增属性时会触发\n                    childObj.dep.depend() // 数组增加依赖\n                    if (Array.isArray(value)) { // 处理多维数组\n                        dependArray(value)\n                    }\n                }\n            }\n            return value;\n        },\n        set(newValue) {\n            console.log('set', key)\n            // 如果用户设置的是对象也要继续劫持\n            observer(newValue)\n            if (newValue === value) return;\n            value = newValue;\n            dep.notify()\n        }\n    })\n}\n\nexport default function observer(data) {\n    // 只能对对象类型进行观测，非对象类型无法进行观测\n    if (typeof data !== 'object' || data === null) return\n    if (data.__ob__) {\n        return\n    }\n    // 通过类来实现对数据对观测，类可以方便扩展，会产生实例\n    return new Observer(data)\n}\n","let callbacks = []\nlet waiting = false\n\nfunction flushCallbacks() {\n    for (let cb of callbacks) {\n        cb()\n    }\n    waiting = false\n    callbacks = []\n}\n\n// 批处理，第一次开启定时器，后序只更新列表，之后执行清空逻辑\n// 第一次cb 渲染watcher更新操作会调用nextTick 渲染watcher执行的过程肯定是同步的\n// 第二次cb 用户传人nextTick的回调，\nexport function nextTick(cb) {\n    callbacks.push(cb) // 默认的cb是渲染逻辑，用户的逻辑放到渲染逻辑之后就行。\n    if (!waiting) {\n        waiting = true;\n        // vue2做降级，vue3直接用promise.then了\n        // 1、promise是否支持\n        // 2、mutationObserver\n        // 3、setImmediate\n        // 4、setTimeout\n        Promise.resolve().then(flushCallbacks)\n    }\n}\n\nexport const isObject = (val) => typeof val === 'object' && val !== null;\n// 策略\nconst LIFECYCLE_HOOKS = [\n    'beforeCreate',\n    'created',\n]\nconst strategies = {} // 策略集合\n// 钩子合并策略\nLIFECYCLE_HOOKS.forEach(hook => {\n    strategies[hook] = function mergeHooks(parentValue, childValue) {\n        if (!childValue) {\n            // 儿子没有，用父亲\n            return parentValue;\n        } else {\n            if (parentValue) {\n                // 都有\n                return parentValue.concat(childValue)\n            } else {\n                // 只有儿子\n                return [childValue]\n            }\n        }\n    }\n})\n// 其他策略\n// strategies.data = function () {\n// }\n// 组件的合并策略\nstrategies.components = function (parentValue, childValue) {\n    // 查找链\n    const res = Object.create(parentValue)\n    if (childValue) {\n        for (let key in childValue) {\n            res[key] = childValue[key]\n        }\n    }\n    return res;\n}\n\nexport function mergeOptions(parent, child) {\n    let options = {}\n    // 不同的生命周期的合并策略（策略模式）\n\n    // 普通属性的合并策略\n    // 1 如何父亲有儿子没，应该儿子替换父亲\n    // 2 如果父亲有值，用父亲的\n    for (let key in parent) {\n        mergeField(key)\n    }\n\n    for (let key in child) {\n        if (!parent.hasOwnProperty(key)) {\n            mergeField(key)\n        }\n    }\n\n    function mergeField(key) {\n        if (strategies[key]) {\n            return options[key] = strategies[key](parent[key], child[key])\n        }\n        if (isObject(parent[key]) && isObject(child[key])) {\n            options[key] = {...parent[key], ...child[key]}\n        } else {\n            if (child[key]) {\n                options[key] = child[key]\n            } else {\n                options[key] = parent[key]\n            }\n        }\n    }\n\n    return options\n}\n\nfunction makeUp(str) {\n    const map = {}\n    str.split(',').forEach(tagName => {\n        map[tagName] = true\n    })\n    return (tag) => map[tag] || false;\n}\n\nexport const isReservedTag = makeUp('a,p,div,ul,li,span,input,button')\n\n\nexport function isSameVnode(oldVnode, newVnode) {\n    return (oldVnode.tag === newVnode.tag && oldVnode.key === newVnode.key)\n}\n\nexport const isFunction = (val) => Object.prototype.toString.call(val) === '[object Function]'\n","import {nextTick} from \"../utils\";\n\nlet has = {}\nlet queue = []\nlet pending = false\n\nfunction flushSchedulerQueue() {\n    for (let watcher of queue) {\n        watcher.run()\n    }\n    has = {}\n    queue = []\n    pending = false\n}\n\n// 多次调用queueWatcher，可能会开启多个nextTick ，如果watcher不是同一个,\nexport function queueWatcher(watcher) {\n    // 调度更新几次\n    // 更新是对watcher进行重新操作\n    let id = watcher.id;\n    if (has[id] == null) { // 没有id\n        queue.push(watcher);\n        has[id] = true;\n        if (!pending) { // 加锁\n            pending = true\n            // 让queue清空\n            nextTick(flushSchedulerQueue)\n        }\n        // setTimeout(() => {\n        //     flushSchedulerQueue()\n        // }, 0)\n    }\n}\n","import {popTarget, pushTarget} from \"./dep\";\nimport {queueWatcher} from \"./scheduler\";\nimport {isFunction} from \"../utils\";\n\nlet id = 0;\n\nexport class Watcher {\n    constructor(vm, exprOrFn, cb, options) {\n        this.id = id++\n        this.vm = vm;\n        this.cb = cb;\n        this.options = options;\n        this.sync = options.sync; // 用户watcher传入的可以，可以设置同步watcher\n        if (isFunction(exprOrFn)) {\n            this.getter = exprOrFn\n        } else {\n            // 将getter封装成了取值函数\n            this.getter = () => { // 'a.b.c.d'\n                // 处理用户传人的可能\n                let paths = exprOrFn.split('.')\n                let val = vm;\n                for (let path of paths) {\n                    val = val[path]\n                }\n                return val\n            }\n        }\n        this.user = options.user\n        this.deps = [] //  如果是相同页面多个标签取get一个属性，会触发多次.\n        this.depsId = new Set() // dep去重\n        this.lazy = options.lazy\n        this.dirty = this.lazy\n        this.value = this.lazy ? undefined : this.get() // 保存老值\n        // this.exprOrFn() // 调用传人的函数。调用了render方法，此时会对模版中的数据进行取值\n    }\n\n    get() {\n        pushTarget(this) // 1、将当前watcher放到Dep上， Dep.target = watcher\n        let value = this.getter.call(this.vm) // 2、对属性进行取值 vm._update(vm._render()) // 生成真实dom了，过程中会对模版中对属性进行get操作，触发Observer get同时添加到dep\n        popTarget() // 3、清空Dep.target = null，不在模版中访问对值不记录watcher\n        return value;\n    }\n\n    //\n    addDep(dep) { //\n        const id = dep.id\n        // 一个dep可能对应多个watcher，\n        if (!this.depsId.has(id)) { // dep去重,watcher也驱虫了\n            this.depsId.add(id)\n            this.deps.push(dep)// 让watcher记住dep\n            dep.addSub(this) // 让dep记住watcher,唯一的dep记住唯一的watcher\n        }\n    }\n\n    evaluate() {\n        this.value = this.get()\n        this.dirty = false\n    }\n\n    update() {\n        if (this.sync) {\n            this.run()\n        } else if (this.lazy) {\n            this.dirty = true\n        } else {\n            // this.get() // 数据一变重新渲染，同一个事件环中多次更新会触发多次\n            queueWatcher(this); // 批处理，调度更新几次，\n\n        }\n    }\n\n    depend() { // computed时需要将栈中其他的watcher也进行收集\n        let i = this.deps.length;\n        debugger\n        while (i--) {\n            this.deps[i].depend()\n        }\n    }\n\n    run() {\n        // this.get();\n        let oldValue = this.value;\n        let newValue = this.get();\n        this.value = newValue\n        if (this.user) { // 用户的watcher，执行用户的callback，并将新值就值传入\n            this.cb.call(this.vm, oldValue, newValue)\n        }\n    }\n\n    // 当属性取值时要记住这个watcher，稍后数据变化了，去执行自己记住的watcher即可。依赖收集\n}\n\n\n\n","import observer from \"./observer/index\";\nimport {isFunction, isObject} from \"./utils\";\nimport {Watcher} from \"./observer/watcher\";\nimport Dep from \"./observer/dep\";\n\nexport function initState(vm) {\n    // 将所有的数据定义在vm属性上，并且后序修改，需要触发视图更新\n    const opts = vm.$options;\n    if (opts.props) {\n        initProps(vm)\n    }\n    if (opts.methods) {\n        initMethods(vm, opts.methods)\n    }\n    if (opts.data) {\n        initData(vm)\n    }\n    if (opts.watch) {\n        initWatch(vm, opts.watch)\n    }\n    if (opts.computed) {\n        initComputed(vm, opts.computed)\n    }\n}\n\nfunction proxy(vm, source, key) {\n    Object.defineProperty(vm, key, {\n        get() {\n            return vm[source][key]\n        },\n        set(newValue) {\n            vm[source][key] = newValue\n        }\n    })\n}\n\nfunction initData(vm) {\n    // 数据劫持\n    // Object.prototype.defineProperty\n    let data = vm.$options.data;\n    // 判断data的类型是函数还是对象\n    // vm._data可以拿到劫持后对数据\n    data = vm._data = typeof data === 'function' ? data.call(vm) : data;\n    // 将_data上对数据全部代理到vm上\n    for (let key in data) {\n        proxy(vm, '_data', key) // vm.name => vm._data.name\n    }\n    // 观测这个数据\n    observer(data)\n}\n\nfunction initComputed(vm, computed) {\n    // 内部也是通过watcher实现的\n    // 存放所有计算属性对应的watcher\n    const watchers = vm._computedWatchers = {};\n    for (let key in computed) {\n        const userDef = computed[key] // 获取用户定义的函数\n        const getter = typeof userDef === 'function' ? userDef : userDef.get\n        // 获取用户getter方法\n        // 计算属性的Watcher不会立刻执行\n        // lazy为true，内部不会立刻调用getter\n        watchers[key] = new Watcher(vm, getter, () => {\n        }, {lazy: true})\n\n        // 计算属性可以直接通过vm来进行取值\n        defineComputed(vm, key, userDef);\n    }\n}\n\nconst sharedPropertyDefinition = {\n    enumerable: true,\n    configurable: true,\n    get: () => {\n    },\n    set: () => {\n    }\n}\n\n// 将属性定义到vm上\nfunction defineComputed(target, key, userDef) {\n    if (typeof userDef === 'function') {\n        sharedPropertyDefinition.get = createComputedGetter(key)\n    } else {\n        sharedPropertyDefinition.get = createComputedGetter(key).get;\n        sharedPropertyDefinition.set = userDef.set || (() => {\n        })\n    }\n    Object.defineProperty(target, key, sharedPropertyDefinition)\n}\n\nfunction createComputedGetter(key) {\n    // 增加缓存\n    return function () { // 添加来缓存 通过watcher来添加到\n        // console.log(this) // vm实例\n        let watcher = this._computedWatchers[key]\n        if (watcher?.dirty) { // 默认第一次取值,如果dirty为true，就调用用户到方法\n            watcher.evaluate(); // 执行取值\n        }\n        if (Dep.target) {\n            // 这里的watcher是计算属性watcher\n            watcher.depend()// 渲染watcher也一起收集\n        }\n        return watcher.value;\n    }\n}\n\nfunction initMethods(vm, methods) {\n    for (let key in methods) {\n        proxy(vm, methods[key], key)\n    }\n}\n\nfunction initProps(vm) {\n}\n\nfunction initWatch(vm, watch) {\n    // watch是个对象\n    // watch原理是Watcher\n    for (let key in watch) {\n        const handlers = watch[key];\n        // handlers可能是数组 对象 方法\n        if (Array.isArray(handlers)) {//\n            for (let handler of handlers) {\n                createWatcher(vm, key, handler)\n            }\n        } else {\n            // 单独的key value\n            createWatcher(vm, key, handlers)\n        }\n    }\n}\n\nfunction createWatcher(vm, key, handler, options) {\n    if (isObject(handler)) {\n        options = handler\n        handler = handler.handler;\n    } else if (typeof handler === 'string') {\n        handler = vm[handler]\n    }\n    // 参数的格式化 扁平化\n    // console.log(key, handler, options)\n    // 基于$watch , 原型的方法\n    return vm.$watch(key, handler, options)\n}\n\nexport function stateMixin(Vue) {\n    Vue.prototype.$watch = function (exprOrFn, handler, options = {}) {\n        const vm = this\n        // 用户的watcher\n        // console.log(exprOrFn)\n        options.user = true; // 用户自己写的wathcer\n        new Watcher(vm, exprOrFn, handler, options)\n    }\n}\n","// 标签名 aa-aa\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // aa-aa\n// 标签名，命名空间标签 aa:aa\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; //aa:aa\n// 开始标签 <div\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 可以匹配到标签名  [1]\n// 结束标签 <\\div>\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); //[0] 标签的结束名字\n// 属性  style=\"xxx\"   style='xxx'  style=xxx\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\n// 开始标签闭合  >\nconst startTagClose = /^\\s*(\\/?)>/;\n\n// console.log(`a='1'`.match(attribute));\n\n// <div style=\"color:red\">\n//  <span></span>\n// </div>\n// html ---> ast\n// let ast = {\n//     tag:'div',\n//     type:1, // nodeType\n//     attrs:[{style:\"color:red\"}],\n//     children:[{\n//         tag: 'span',\n//         type:1,\n//         attrs:[],\n//         children:[]\n//     }]\n// }\n// 解析过程，从头往后匹配，匹配到一个就截取掉，直到截取完毕。状态机\n\nexport function parseHtml(html) {\n    let root = null;\n    let currentParent = null;\n    let stack = []\n    // 创建ast\n    function createASTElement(tag, attrs) {\n        // vue3支持多个根元素(外面加了一个空元素）， vue2中只有一个根节点.\n        return {\n            tag,\n            type: 1,\n            children: [],\n            attrs,\n            parent: null,\n        }\n    }\n\n    // 根据开始标签，结束标签，文本内容 生成一个ast语法树\n    function start(tagName, attrs) {\n        let element = createASTElement(tagName, attrs)\n        if (!root) {\n            // 第一个元素\n            root = element\n        }\n        currentParent = element;\n        stack.push(element);\n    }\n\n    function end(tagName) {\n        let element = stack.pop();\n        currentParent = stack[stack.length - 1];\n        if (currentParent) {\n            element.parent = currentParent;\n            currentParent.children.push(element);\n        }\n\n    }\n\n    function chars(text) {\n        text = text.replace(/\\s/g, '')\n        if (text) {\n            currentParent.children.push({\n                type: 3,\n                text\n            })\n        }\n    }\n\n    // 截取前n位字符串\n    function advance(n) {\n        html = html.substring(n)\n    }\n\n    // 匹配开始标签和属性\n    function parseStartTag() {\n        const start = html.match(startTagOpen) // 匹配开头标签 <div\n        if (start) {\n            let match = {\n                tagName: start[1],\n                attrs: []\n            }\n            advance(start[0].length) // 获取元素\n            // console.log(html)\n            // 查找属性, 不是开头结束标签的就一直匹配\n            let end, attr;\n            while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\n                advance(attr[0].length)\n                match.attrs.push({\n                    name: attr[1],\n                    value: attr[3] || attr[4] || attr[5] || true\n                })\n            }\n            if (end) {\n                advance(end[0].length)\n                return match;\n            }\n        }\n    }\n\n    while (html) {\n        let textEnd = html.indexOf('<');\n        if (textEnd === 0) {\n            let startTagMatch = parseStartTag()\n            if (startTagMatch) { // 是个开始标签\n                start(startTagMatch.tagName, startTagMatch.attrs)\n                // console.log('开始标签',startTagMatch.tagName)\n                continue;\n            }\n            let endTagMatch = html.match(endTag);\n            if (endTagMatch) {// 是个结束标签\n                end(endTagMatch[1])\n                // console.log('结束标签',endTagMatch[1])\n                advance(endTagMatch[0].length)\n                continue;\n            }\n            // break;\n        }\n        let text;\n        if (textEnd > 0) { // 开始解析文本\n            text = html.substring(0, textEnd)\n        }\n        if (text) {\n            advance(text.length)\n            chars(text)\n            // console.log('文本节点',text)\n        }\n    }\n\n    return root\n}\n","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g // {{}} 匹配差值表达式的\nfunction genProps(attrs) {\n    let str = ''\n    for (let attr of attrs) {\n        // 属性名为style，指令等需要单独处理\n        let {name, value} = attr;\n\n        if (name === 'style') {\n            //  style=\"color:green;width:100px\"\n            //  --> style:{\"color\":\"green\",\"width\":\"100px\"}\n            value = value.split(';').reduce((p, n) => {\n                let [key, v] = n.split(':');\n                p[key] = v\n                return p\n            }, {})\n        }\n        str += `${name}:${JSON.stringify(value)},`\n    }\n    return `{${str.slice(0, -1)}}`\n\n}\n\nfunction genChildren(el) {\n    let children = el.children;\n\n    function gen(node) { // 要区分元素还是文本\n        if (node.type === 1) {\n            return generate(node)\n        }\n        if (node.type === 3) {\n            // 文本逻辑不能用_c\n            // 分三种\n            // 1、有{{}}的\n            // 2、普通文本\n            // 3、混合文本\n            let text = node.text;\n            // debugger\n            if (text.match(defaultTagRE)) {\n                // 处理差值表达式\n                // name {{name}} age {{age}} cc\n                // -> _v(\"name\"+_s(name)+\"age\"+_s(age)+\"cc\")\n                let tokens = [];\n                let match;\n                let index;\n                let lastIndex = defaultTagRE.lastIndex = 0;// lastIndex下次匹配的索引\n                while (match = defaultTagRE.exec(text)) {\n                    index = match.index;\n                    if (index > lastIndex) {\n                        tokens.push(JSON.stringify(text.slice(lastIndex, index)))\n                    }\n                    tokens.push(`_s(${match[1].trim()})`);\n                    lastIndex = index + match[0].length;\n                }\n                if (lastIndex < text.length) {\n                    // 最后没匹配上的也需要放进去\n                    tokens.push(JSON.stringify(text.slice(lastIndex)))\n                }\n                return `_v(${tokens.join('+')})`\n            } else {\n\n                return `_v(${JSON.stringify(text)})`;\n\n            }\n        }\n    }\n\n    if (children) {\n        return children.map(child => gen(child)).join(',')\n    }\n}\n\n/**\n * ast-> js(render)\n * @param el\n */\nexport function generate(el) {\n    // ast树 -》 js代码  语法本身的转换\n    // 转换成render代码\n    let children = genChildren(el)\n    let code = `_c(${JSON.stringify(el.tag)},${\n        el.attrs.length ? genProps(el.attrs) : 'undefined'\n    }\n        ${\n        children ? ',' + children : ''\n    }\n    )`\n    return code\n}\n\n/**\n <div id=\"app\" a=\"1\" b=\"2\">\n <span style=\"color:red\">\n {{name}}\n <a href=\"#\">hello</a>\n </span>\n </div>\n // ast -> render函数的js\n // js -> 虚拟dom\n // render函数生成的是虚拟dom\n function render() {\n    return _c(\n        'div',// tag\n        {id: 'app', a: '1', b: '2'},// 标签属性\n        _c( // 第一个children\n            'span',\n            {style: 'color:red'},\n            _s(name),// 模版字符串\n            _c('a',\n                {},\n                _v('hello')) // 文本节点\n        )\n    )\n}\n **/\n\n\n\n","import {parseHtml} from \"./parse\";\nimport {generate} from \"./generate\";\n\nexport function compileToFunction(template) {\n    // 1、template源码 -> ast语法树\n    const el = parseHtml(template)\n    // 2、 ast -> render code -> render function\n    // ast语法树 -> 包装成render函数体的字符串  _c('div',{},_c('span'))\n    let code = generate(el)\n    // 函数体字符串 ——> 包装成 --> render函数\n    let render = new Function(`\n    with(this){\n        return ${code}\n    }\n    `)\n    // 3、render function done -> virtual dom\n    return render\n    // with和eval的区别，eval不干净，会获取到外面的值\n}\n\n\n","import {isSameVnode} from \"../utils\";\n\nexport function patch(oldVnode, vnode) {\n    if (!oldVnode) {\n        // 子组件渲染的时候没有oldVnode作为老组件\n        // 直接根据虚拟节点创建元素\n        return createElm(vnode)\n    }\n    // 首次渲染oldvnode是真实的dom元素\n    const isRealElement = oldVnode.nodeType;\n    if (isRealElement) {\n        // 2、首次\n        // 初次渲染\n        const oldElm = oldVnode\n        const parentElm = oldElm.parentNode;\n        // 根据虚拟节点创建真实的节点\n        let el = createElm(vnode);\n        parentElm.insertBefore(el, oldElm.nextSibling);\n        parentElm.removeChild(oldElm)\n        return el\n    } else {\n        // 3、两个虚拟节点的比对\n        // 更新 diff算法\n        // 1、如果新旧两个节点标签不一样，直接替换\n        if (oldVnode.tag !== vnode.tag) {\n            return oldVnode.el.parentNode.replaceChild(createElm(vnode), oldVnode.el)\n        }\n        // 2、标签相同但是是两个文本节点\n        if (!oldVnode.tag) {\n            if (oldVnode.text !== vnode.text) {\n                return oldVnode.el.textContent = vnode.text\n            }\n        }\n        // 3、元素相同，复用老节点，更新属性\n        let el = vnode.el = oldVnode.el; //\n        updateProperties(vnode, oldVnode.data) // 用老的属性和新的节点属性比对\n\n        // 4、标签 属性都一样了，更新儿子！！\n        let oldChildren = oldVnode.children || [];\n        let newChildren = vnode.children || [];\n        if (oldChildren.length > 0 && newChildren.length > 0) {\n            // 1) 老的新的都有儿子（diff算法）\n            updateChildren(el, oldChildren, newChildren)\n        } else if (oldChildren > 0) {\n            // 2) 老的有新的没有儿子：直接删除老儿子\n            el.innerHTML = ''\n        } else if (newChildren.length > 0) {\n            // 3) 老的没儿子新的有儿子：在老节点新增儿子即可\n            newChildren.forEach(child => {\n                el.appendChild(createElm(child))\n            })\n        }\n    }\n}\n\n\nfunction updateChildren(parent, oldChildren, newChildren) {\n    // 核心diff算法\n    // 双指针\n    let oldStartIndex = 0; // 老头索引\n    let oldEndIndex = oldChildren.length - 1; // 老尾索引\n    let oldStartVnode = oldChildren[0]; // 老开始节点\n    let oldEndVnode = oldChildren[oldEndIndex]\n\n    let newStartIndex = 0; // 新头索引\n    let newEndIndex = newChildren.length - 1; // 新尾索引\n    let newStartVnode = newChildren[0]; // 新开始节点\n    let newEndVnode = newChildren[newEndIndex]\n\n    function makeIndexByKey(oldChildren) {\n        return oldChildren.reduce((map, child, index) => {\n            if (child.key !== undefined) {\n                map[child.key] = index\n            }\n            return map\n        }, {})\n    }\n\n    let map = makeIndexByKey(oldChildren);\n    // 从头往后比\n    while (oldStartIndex <= oldEndIndex && newStartIndex <= newEndIndex) {\n        // dom的移动性，\n        // 尾部插入、头部插入、头部移动到尾部、尾部移动到头部、正序、反序\n        if (!oldStartVnode) {\n            // 空白节点直接跳过\n            oldStartVnode = oldChildren[++oldStartIndex]\n        } else if (!oldEndVnode) {\n            // 空白节点直接跳过\n            oldEndVnode = oldChildren[--oldEndIndex]\n        } else if (isSameVnode(oldStartVnode, newStartVnode)) {\n            // 1 头和头相比 尾部插入\n            patch(oldStartVnode, newStartVnode) // 递归，深度遍历\n            oldStartVnode = oldChildren[++oldStartIndex];\n            newStartVnode = newChildren[++newStartIndex];\n        } else if (isSameVnode(oldEndVnode, newEndVnode)) {\n            // 2 尾和尾比 头部插入\n            patch(oldEndVnode, newEndVnode) // 递归，深度遍历\n            oldEndVnode = oldChildren[--oldEndIndex];\n            newEndVnode = newChildren[--newEndIndex];\n        } else if (isSameVnode(oldStartVnode, newEndVnode)) {\n            // 3  老头和新尾比  将老的头部节点移动到老的尾节点后面. 头和尾交叉比,\n            patch(oldStartVnode, newEndVnode)\n            parent.insertBefore(oldStartVnode.el, oldEndVnode.el.nextSibling)\n            oldStartVnode = oldChildren[++oldStartIndex];\n            newEndVnode = newChildren[--newEndIndex];\n        } else if (isSameVnode(oldEndVnode, newStartVnode)) {\n            // 4 老尾和新头比  将老的尾部节点移动到老的头节点前面, 头和尾交叉比，\n            patch(oldEndVnode, newStartVnode)\n            parent.insertBefore(oldEndVnode.el, oldStartVnode.el)\n            oldEndVnode = oldChildren[--oldEndIndex];\n            newStartVnode = newChildren[++newStartIndex];\n        } else {\n            // 5 乱序\n            // 需要先查找当前 老节点索引和key的关系\n            // 移动的时候通过新的key，去找对应的老节点索引 --》 获取老节点，可以移动老节点\n            let moveIndex = map[newStartVnode.key]\n            if (moveIndex === undefined) { // 判断新的儿子在老儿子里有没有对应的key\n                parent.insertBefore(createElm(newStartVnode), oldStartVnode.el)\n            } else {\n                let moveVnode = oldChildren[moveIndex]\n                oldChildren[moveIndex] = undefined;\n                patch(moveVnode, newStartVnode) // 如果找到了 再对两者的进行深层比对\n                parent.insertBefore(moveVnode.el, oldStartVnode.el)\n            }\n            newStartVnode = newChildren[++newStartIndex]\n        }\n\n        // 为什么v-for要增加key？为啥不能用index\n\n    }\n    if (newStartIndex <= newEndIndex) { // 新到比老到多，插入新节点\n        for (let i = newStartIndex; i <= newEndIndex; i++) {\n            // 像前插入或者向后插入\n            // 看一下后面又没下一个节点，有的话向前插入\n            let nextEle = newChildren[newEndIndex + 1] == null ? null : newChildren[newEndIndex + 1].el\n            // appendChild 和 insertBefore 也可以进行合并\n            // 如果insertBefore 传入null 等价于appendChild\n            parent.insertBefore(createElm(newChildren[i]), nextEle)\n        }\n    }\n    if (oldStartIndex <= oldEndIndex) {\n        for (let i = oldStartIndex; i <= oldEndIndex; i++) {\n            let child = oldChildren[i]\n            if (child !== undefined) {\n                parent.removeChild(child.el)\n            }\n        }\n    }\n\n}\n\n// vnode -》真实dom\nexport function createElm(vnode) {\n    let {tag, children, key, data, text, vm} = vnode;\n    if (typeof tag === 'string') {// 组件或者原生标签\n        //  如果是组件\n        if (createComponent(vnode)) {\n            return vnode.componentInstance.$el\n        }\n        vnode.el = document.createElement(tag) //\n        updateProperties(vnode)\n        children.forEach(child => {\n            // 有可能是文本\n            vnode.el.appendChild(createElm(child))\n        })\n    } else {\n        vnode.el = document.createTextNode(text)\n    }\n    return vnode.el;\n}\n\n// 创建组件\nfunction createComponent(vnode) {\n    let i = vnode.data;\n    if ((i = i.hook) && (i = i.init)) { // 连续取值\n        i(vnode) // init回调，会想vnode增加componentInstance属性\n    }\n    if (vnode.componentInstance) {\n        return true\n    }\n}\n\n// 更新属性\nfunction updateProperties(vnode, oldProps = {}) {\n    let newProps = vnode.data || {}; // 属性\n    let el = vnode.el; // dom元素\n    // 1、老的有,新的没：删除\n    for (let key in oldProps) {\n        if (!newProps[key]) {\n            el.removeAttribute(key) // 新版浏览器会有个批处理，多次修改会合并。\n        }\n    }\n    // style需要特殊判断\n    let newStyle = newProps.style || {};\n    let oldStyle = oldProps.style || {};\n    for (let key in oldStyle) {\n        if (!newStyle[key]) {\n            el.style[key] = ''\n        }\n    }\n\n    // 2、新的有老的没：新增\n    // 3、老的新的都有直接覆盖\n    for (let key in newProps) {\n        if (key === 'style') {\n            for (let styleKey in newProps.style) {\n                el.style[styleKey] = newProps.style[styleKey]\n            }\n        } else if (key === 'class') {\n            el.className = newProps.class\n        } else {\n            el.setAttribute(key, newProps[key])\n        }\n    }\n}\n","import {Watcher} from \"./observer/watcher\";\nimport {patch} from \"./vdom/patch\";\n\nexport function lifecycleMixin(Vue) {\n    Vue.prototype._update = function (vnode) {\n        // 将虚拟节点转换成真实dom\n        const vm = this;\n        // 首次渲染 需要用虚拟节点，来更新真实的dom元素\n        // vm.$el = patch(vm.$options.el, vnode)\n        // 第一次渲染完毕后，拿到新的节点，下次更新再次渲染时替换上次渲染的结果\n\n        // 第一次初始化 第二次diff算法\n        const preVnode = vm._vnode // 取上次vnode\n        vm._vnode = vnode;\n        if (!preVnode) {\n            vm.$el = patch(vm.$el, vnode) // 组件渲染时调用patch方法会产生$el属性\n        } else {\n            vm.$el = patch(preVnode, vnode) // 第二次 diff算法\n        }\n    }\n}\n\nexport function callHook(vm, hook) { // 发布模式\n    const handlers = vm.$options[hook]\n    if (handlers) {\n        handlers.forEach(handler => handler.call(vm))\n    }\n}\n\nexport function mountComponent(vm) {\n    // 默认vue是通过watcher来渲染的，渲染watcher 每一个组件都有一个渲染watcher\n    function updateComponent() {\n        vm._update(vm._render(vm)); //  vm._render()获取虚拟节点（虚拟dom） _update把虚拟节点变成真实节点\n    }\n\n    // 其实就是执行updateComponent, 不过需要创建一个渲染watcher, 将watcher放到Dep.target上, 然后进行取值；最后清空Dep.target\n    new Watcher(vm, updateComponent, () => {\n    }, true)\n}\n\n","import {initState} from \"./state\";\nimport {compileToFunction} from \"./compiler/index\";\nimport {callHook, mountComponent} from \"./lifecycle\";\nimport {mergeOptions, nextTick} from \"./utils\";\n\nexport default function initMixin(Vue) {\n    Vue.prototype._init = function (options) { // 这个options是用户传人的配置\n        const vm = this\n        // 初始化状态\n        // 合并选项 vm.constructor代表的是当前实例的构造函数\n        vm.$options = mergeOptions(vm.constructor.options, options)\n        // vm.$options = options;\n        callHook(vm, 'beforeCreate') // 增加钩子，发布\n        initState(vm);//\n        callHook(vm, 'created') // 增加钩子，帆布\n\n\n        if (vm.$options.el) { // 判断是否有el直接挂载\n            vm.$mount(vm.$options.el)\n        }\n    }\n    Vue.prototype.$nextTick = nextTick\n    Vue.prototype.$mount = function (el) {\n        el = el && document.querySelector(el)\n        const vm = this;\n        const options = vm.$options;\n        vm.$el = el;\n        // 如果有render直接使用\n        // 没有render， 看有没有template属性\n        // 没有template，找外部模版\n        if (!options.render) {\n            let template = options.template\n            if (!template && el) {\n                template = el.outerHTML // 火狐不兼容\n                // template = document.createElement('div').appendChild(el).innerHTML\n            }\n            // 拿到html模版,如何将模版编译成render函数\n            // html template -> render函数\n            const render = compileToFunction(template)\n            options.render = render;\n        }\n        mountComponent(vm) // 组件挂载\n\n    }\n}\n\n\n\n","import {isObject, isReservedTag} from \"../utils\";\n\nexport function createElement(vm, tag, data = {}, ...children) {\n    // 需要区分原生标签和自定义标签（组件）\n    // console.log(tag,isReservedTag(tag))\n    if (isReservedTag(tag)) {\n        return Vnode(vm, tag, data, data.key, children, undefined)\n    } else {\n        // 不是一个普通标签，就是组件了\n        const Ctor = vm.$options.components[tag] // 内部创建的组件是对象，外部创建的是函数\n        // return {text:1234}\n        return createComponentVnode(vm, tag, data, data.key, children, Ctor)\n        // tag可能是对象？\n    }\n}\n\nexport function createComponentVnode(vm, tag, data, key, children, Ctor) {\n    if (isObject(Ctor)) {\n        // 将对象转成函数,组件的核心就是.extend\n        // 组件的构造函数\n        Ctor = vm.$options._base.extend(Ctor)\n    }\n    // 给组件增加生命周期\n    data.hook = {\n        init(vnode) {\n            // 初始化的钩子\n            // 调用子组件的构造函数,获取子组件实例\n            let child = vnode.componentInstance = new vnode.componentOptions.Ctor({})\n            child.$mount() // 子组件手动挂载 child.$el == vnode.componentInstance.$el == 真实元素\n        }\n    }\n    // 组件的虚拟节点拥有hook和当前组件的componentOptions中存放了组件的构造函数\n    return Vnode(vm, `vue-component-${Ctor.cid}-${tag}`, data, key, undefined, undefined, {Ctor});\n\n}\n\nexport function createTextVnode(vm, text) {\n    return Vnode(vm, undefined, undefined, undefined, undefined, text)\n}\n\nfunction Vnode(vm, tag, data, key, children, text, componentOptions) {\n    return {\n        vm,\n        tag,\n        data,\n        key,\n        text,\n        children,\n        componentOptions\n    }\n}\n","import {createElement, createTextVnode} from \"./vdom/index\";\n\nexport function renderMixin(Vue) {\n    Vue.prototype._c = function (...args) {\n        // 创建元素的虚拟节点\n        return createElement(this, ...args)\n    }\n    Vue.prototype._v = function (text) {\n        // 创建文本的虚拟节点\n        return createTextVnode(this, text)\n\n    }\n    Vue.prototype._s = function (val) {\n        // 转换成字符串\n        return (val === null ? \"\" :\n            (typeof val === 'object') ? JSON.stringify(val) :\n                val)\n    }\n    // 产生虚拟dom\n    Vue.prototype._render = function () {\n        const vm = this;\n        let render = vm.$options.render;\n        // 调用render方法产生虚拟节点\n        let vnode = render.call(vm); // _c(xx,xx,xx) 调用是会自动将变量进行取值，将其结果进行渲染\n        return vnode;\n    }\n}\n","import {mergeOptions} from \"../utils\";\n\nexport function initGlobalAPI(Vue) {\n    Vue.options = {} // 存储全局配置\n    // filter directive component\n    Vue.mixin = function (mixin) {\n        this.options = mergeOptions(this.options, mixin)\n        console.log(this.options)\n        return this;\n    }\n    Vue.options._base = Vue;// 永远执行Vue的构造函数\n    Vue.options.components = {}; // 内部的局部组件\n    Vue.component = function (id, definition) {\n        definition.name = definition.name || id // 组件的名字先采用对象内写的\n\n        // 通过一个对象产生一个构造函数, 保证永远使用的是Vue的extend,\n        // 不管谁调component, 最后extend中返回的子类都是继承自原始的Vue。this.options._base永远指向Vue\n        definition = this.options._base.extend(definition)\n        // definition = Vue.extend(definition)\n        this.options.components[id] = definition;\n    }\n    let cid = 0\n    Vue.extend = function (options) {\n        const Super = this;\n        // 子组件初始化时会 new VueComponent(options)\n        const Sub = function VueComponent(options) {\n            this._init(options)\n        }\n        Sub.cid = cid++\n        // 子类继承父类\n        // 继承原型方法，所有组件 不管是子类还是孙子类都继承自原始的Vue\n        Sub.prototype = Object.create(Super.prototype)\n        Sub.prototype.constructor = Sub;\n        Sub.component = Super.component;\n        // 子类的options\n        Sub.options = mergeOptions(Super.options, options)\n        return Sub\n    }\n    // Sub.component()\n}\n\n","// vue2 options API 无法tree-shaking\n// vue2中就是一个构造函数 class不好用mixin增加属性\nimport initMixin from \"./init\";\nimport {lifecycleMixin} from \"./lifecycle\";\nimport {renderMixin} from \"./render\";\nimport {initGlobalAPI} from \"./global-api/index\";\nimport {stateMixin} from \"./state\";\n\nfunction Vue(options) {\n    this._init(options);\n}\n\n// // 可以拆分逻辑到不同的文件中 更利于代码维护 模块化的概念\n// Vue.prototype._init = function () {\n// }\ninitMixin(Vue)\nlifecycleMixin(Vue)\nrenderMixin(Vue)\ninitGlobalAPI(Vue)\nstateMixin(Vue)\n\nlet vm1 = new Vue({name:'zf'})\nexport default Vue;\n\n"],"names":["oldArrayProtoMethod","Array","prototype","arrayMethods","Object","create","methods","forEach","_method","console","log","args","result","call","inserted","__obj__","__ob__","slice","observeArray","dep","notify","id","Dep","subs","target","addDep","watcher","push","update","pushTarget","popTarget","Observer","value","defineProperty","enumerable","configurable","isArray","setPrototypeOf","walk","item","observer","data","keys","key","defineReactive","dependArray","depend","childObj","get","set","newValue","callbacks","waiting","flushCallbacks","cb","nextTick","Promise","resolve","then","isObject","val","LIFECYCLE_HOOKS","strategies","hook","mergeHooks","parentValue","childValue","concat","components","res","mergeOptions","parent","child","options","mergeField","hasOwnProperty","makeUp","str","map","split","tagName","tag","isReservedTag","isSameVnode","oldVnode","newVnode","isFunction","toString","has","queue","pending","flushSchedulerQueue","run","queueWatcher","Watcher","vm","exprOrFn","sync","getter","paths","path","user","deps","depsId","Set","lazy","dirty","undefined","add","addSub","i","length","oldValue","initState","opts","$options","props","initMethods","initData","watch","initWatch","computed","initComputed","proxy","source","_data","watchers","_computedWatchers","userDef","defineComputed","sharedPropertyDefinition","createComputedGetter","evaluate","handlers","handler","createWatcher","$watch","stateMixin","Vue","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHtml","html","root","currentParent","stack","createASTElement","attrs","type","children","start","element","end","pop","chars","text","replace","advance","n","substring","parseStartTag","match","attr","name","textEnd","indexOf","startTagMatch","endTagMatch","defaultTagRE","genProps","reduce","p","v","JSON","stringify","genChildren","el","gen","node","generate","tokens","index","lastIndex","exec","trim","join","code","compileToFunction","template","render","Function","patch","vnode","createElm","isRealElement","nodeType","oldElm","parentElm","parentNode","insertBefore","nextSibling","removeChild","replaceChild","textContent","updateProperties","oldChildren","newChildren","updateChildren","innerHTML","appendChild","oldStartIndex","oldEndIndex","oldStartVnode","oldEndVnode","newStartIndex","newEndIndex","newStartVnode","newEndVnode","makeIndexByKey","moveIndex","moveVnode","nextEle","createComponent","componentInstance","$el","document","createElement","createTextNode","init","oldProps","newProps","removeAttribute","newStyle","style","oldStyle","styleKey","className","setAttribute","lifecycleMixin","_update","preVnode","_vnode","callHook","mountComponent","updateComponent","_render","initMixin","_init","constructor","$mount","$nextTick","querySelector","outerHTML","Vnode","Ctor","createComponentVnode","_base","extend","componentOptions","cid","createTextVnode","renderMixin","_c","_v","_s","initGlobalAPI","mixin","component","definition","Super","Sub","VueComponent"],"mappings":"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"}