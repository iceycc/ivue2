{"version":3,"file":"vue.js","sources":["../src/observer/array.js","../src/observer/dep.js","../src/observer/index.js","../src/state.js","../src/compiler/parse.js","../src/compiler/generate.js","../src/compiler/index.js","../src/utils.js","../src/observer/scheduler.js","../src/observer/watcher.js","../src/vdom/patch.js","../src/lifecycle.js","../src/init.js","../src/vdom/index.js","../src/render.js","../src/global-api/index.js","../src/index.js","../src/diff.demo.js"],"sourcesContent":["let oldArrayProtoMethod = Array.prototype;\n// 不能直接改写数组的原有数组\nexport let arrayMethods = Object.create(Array.prototype)\nlet methods = [ // 这七个会改写原数组\n    'push',\n    'pop',\n    'shift',\n    'unshift',\n    'sort',\n    'splice',\n    'sort'\n]\n// 根据索引改值还是监听不到。\nmethods.forEach(_method => {\n    // aop\n    arrayMethods[_method] = function (...args) {\n        console.log('数组变化了')\n        let result = oldArrayProtoMethod[_method].call(this, ...args);\n        // 有可能用户新增的数据是对象格式时\n        let inserted;\n        let __obj__ = this.__ob__\n        switch (_method) {\n            case 'push':\n            case 'unshift':\n                inserted = args\n                break;\n            case 'splice':\n                inserted = args.slice(2);\n        }\n        if (inserted) {\n            // observeArray\n            __obj__.observeArray(inserted) // 谁调方法this就指向谁\n\n        }\n        __obj__.dep.notify() // 修改数组时触发通知更新watcher\n        return result;\n    }\n})\n","// 全局一个Dep属性\nlet id = 0\n\nclass Dep {\n    constructor() {\n        this.id = id++\n        this.subs = [] // 属性要记住这个watcher\n    }\n\n    depend() {\n        // 让watcher记住这个dep\n        Dep.target.addDep(this) // 让watcher记住dep\n    }\n    addSub(watcher){ //\n        this.subs.push(watcher)\n    }\n    notify(){\n        this.subs.forEach(watcher=>watcher.update())\n    }\n}\n\nDep.target = null;\n\nexport function pushTarget(watcher) {\n    Dep.target = watcher\n}\n\nexport function popTarget() {\n    Dep.target = null\n}\n\nexport default Dep\n","import {arrayMethods} from \"./array\";\nimport Dep from \"./dep\";\n\nclass Observer {\n    constructor(value) { // 重新定义\n        // value.__ob__ = this; // 这样会死循环，用下面的\n        this.dep = new Dep(); // 给数组本身或者对象本身增加一个一个dep属性\n        Object.defineProperty(value, '__ob__', {\n            value: this,\n            enumerable: false, // 可点数的,可列举的\n            configurable: false // 可配置的\n        })\n        // value数组或者对象\n        if (Array.isArray(value)) {\n            // 数组不用defineProperty\n            // push shift reverse sort 等方法需要重写\n            // value.__proto__ = arrayMethods\n            Object.setPrototypeOf(value, arrayMethods);\n            this.observeArray(value) // 数组原有的值会\n        } else {\n            this.walk(value)\n        }\n    }\n\n    observeArray(value) {\n        for (let item of value) {\n            observer(item)\n        }\n    }\n\n    walk(data) {\n        // 将对象所有key 重新用defineProperty定义成响应式\n        Object.keys(data).forEach(key => {\n            defineReactive(data, key, data[key])\n        })\n    }\n}\n\nfunction dependArray(value) {\n    // 让外层、里层都是一个watcher\n    // 处理多维数组\n    for (let item of value) {\n        item.__ob__ && item.__ob__.dep.depend()\n        if (Array.isArray(item)) { // 递归继续进行依赖收集\n            dependArray(item)\n        }\n    }\n}\n\nexport function defineReactive(data, key, value) {// vue2数据嵌套不可以过深，过深浪费性能\n    let childObj = observer(value); // 对值递归劫持, 返回的数组或者时对象，会有一个dep属性\n    let dep = new Dep() // 每次都会给属性创建一个dep\n    Object.defineProperty(data, key, { // 需要给每个属性增加Dep\n        get() {\n            if (Dep.target) {\n                dep.depend(); // 让这个属性自己的dep记住这个watcher，也让watcher记住这个dep\n                if (childObj) {// 可能数组也可能是对象，一般是数组，只有在$set给对象新增属性时会触发\n                    childObj.dep.depend() // 数组增加依赖\n                    if (Array.isArray(value)) { // 处理多维数组\n                        dependArray(value)\n                    }\n                }\n            }\n            return value;\n        },\n        set(newValue) {\n            console.log('set', key)\n            // 如果用户设置的是对象也要继续劫持\n            observer(newValue)\n            if (newValue === value) return;\n            value = newValue;\n            dep.notify()\n        }\n    })\n}\n\nexport default function observer(data) {\n    // 只能对对象类型进行观测，非对象类型无法进行观测\n    if (typeof data !== 'object' || data === null) return\n    // 通过类来实现对数据对观测，类可以方便扩展，会产生实例\n    if (data.__ob__) {\n        return\n    }\n    return new Observer(data)\n}\n","import observer from \"./observer/index\";\n\nexport function initState(vm) {\n    // 将所有的数据定义在vm属性上，并且后序修改，需要触发视图更新\n    const opts = vm.$options;\n    if (opts.props) {\n    }\n    if (opts.methods) {\n    }\n    if (opts.data) { // 数据初始化\n        initData(vm)\n    }\n}\n\nfunction proxy(vm, source, key) {\n    Object.defineProperty(vm, key, {\n        get() {\n            return vm[source][key]\n        },\n        set(newValue) {\n            vm[source][key] = newValue\n        }\n    })\n}\n\nfunction initData(vm) {\n    // 数据劫持\n    // Object.prototype.defineProperty\n    let data = vm.$options.data;\n    // 判断data的类型是函数还是对象\n    // vm._data可以拿到劫持后对数据\n    data = vm._data = typeof data === 'function' ? data.call(vm) : data;\n    // 将_data上对数据全部代理到vm上\n    for (let key in data) {\n        proxy(vm, '_data', key) // vm.name => vm._data.name\n    }\n    // 观测这个数据\n    observer(data)\n}\n","// 标签名 aa-aa\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // aa-aa\n// 标签名，命名空间标签 aa:aa\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; //aa:aa\n// 开始标签 <div\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 可以匹配到标签名  [1]\n// 结束标签 <\\div>\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); //[0] 标签的结束名字\n// 属性  style=\"xxx\"   style='xxx'  style=xxx\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\n// 开始标签闭合  >\nconst startTagClose = /^\\s*(\\/?)>/;\n\n// console.log(`a='1'`.match(attribute));\n\n// <div style=\"color:red\">\n//  <span></span>\n// </div>\n// html ---> ast\n// let ast = {\n//     tag:'div',\n//     type:1, // nodeType\n//     attrs:[{style:\"color:red\"}],\n//     children:[{\n//         tag: 'span',\n//         type:1,\n//         attrs:[],\n//         children:[]\n//     }]\n// }\n// 解析过程，从头往后匹配，匹配到一个就截取掉，直到截取完毕。状态机\n\nexport function parseHtml(html) {\n    let root = null;\n    let currentParent = null;\n    let stack = []\n    // 创建ast\n    function createASTElement(tag, attrs) {\n        // vue3支持多个根元素(外面加了一个空元素）， vue2中只有一个根节点.\n        return {\n            tag,\n            type: 1,\n            children: [],\n            attrs,\n            parent: null,\n        }\n    }\n\n    // 根据开始标签，结束标签，文本内容 生成一个ast语法树\n    function start(tagName, attrs) {\n        let element = createASTElement(tagName, attrs)\n        if (!root) {\n            // 第一个元素\n            root = element\n        }\n        currentParent = element;\n        stack.push(element);\n    }\n\n    function end(tagName) {\n        let element = stack.pop();\n        currentParent = stack[stack.length - 1];\n        if (currentParent) {\n            element.parent = currentParent;\n            currentParent.children.push(element);\n        }\n\n    }\n\n    function chars(text) {\n        text = text.replace(/\\s/g, '')\n        if (text) {\n            currentParent.children.push({\n                type: 3,\n                text\n            })\n        }\n    }\n\n    // 截取前n位字符串\n    function advance(n) {\n        html = html.substring(n)\n    }\n\n    // 匹配开始标签和属性\n    function parseStartTag() {\n        const start = html.match(startTagOpen) // 匹配开头标签 <div\n        if (start) {\n            let match = {\n                tagName: start[1],\n                attrs: []\n            }\n            advance(start[0].length) // 获取元素\n            // console.log(html)\n            // 查找属性, 不是开头结束标签的就一直匹配\n            let end, attr;\n            while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\n                advance(attr[0].length)\n                match.attrs.push({\n                    name: attr[1],\n                    value: attr[3] || attr[4] || attr[5] || true\n                })\n            }\n            if (end) {\n                advance(end[0].length)\n                return match;\n            }\n        }\n    }\n\n    while (html) {\n        let textEnd = html.indexOf('<');\n        if (textEnd === 0) {\n            let startTagMatch = parseStartTag()\n            if (startTagMatch) { // 是个开始标签\n                start(startTagMatch.tagName, startTagMatch.attrs)\n                // console.log('开始标签',startTagMatch.tagName)\n                continue;\n            }\n            let endTagMatch = html.match(endTag);\n            if (endTagMatch) {// 是个结束标签\n                end(endTagMatch[1])\n                // console.log('结束标签',endTagMatch[1])\n                advance(endTagMatch[0].length)\n                continue;\n            }\n            // break;\n        }\n        let text;\n        if (textEnd > 0) { // 开始解析文本\n            text = html.substring(0, textEnd)\n        }\n        if (text) {\n            advance(text.length)\n            chars(text)\n            // console.log('文本节点',text)\n        }\n    }\n\n    return root\n}\n","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g // {{}} 匹配差值表达式的\nfunction genProps(attrs) {\n    let str = ''\n    for (let attr of attrs) {\n        // 属性名为style，指令等需要单独处理\n        let {name, value} = attr;\n\n        if (name === 'style') {\n            //  style=\"color:green;width:100px\"\n            //  --> style:{\"color\":\"green\",\"width\":\"100px\"}\n            value = value.split(';').reduce((p, n) => {\n                let [key, v] = n.split(':');\n                p[key] = v\n                return p\n            }, {})\n        }\n        str += `${name}:${JSON.stringify(value)},`\n    }\n    return `{${str.slice(0, -1)}}`\n\n}\n\nfunction genChildren(el) {\n    let children = el.children;\n\n    function gen(node) { // 要区分元素还是文本\n        if (node.type === 1) {\n            return generate(node)\n        }\n        if (node.type === 3) {\n            // 文本逻辑不能用_c\n            // 分三种\n            // 1、有{{}}的\n            // 2、普通文本\n            // 3、混合文本\n            let text = node.text;\n            // debugger\n            if (text.match(defaultTagRE)) {\n                // 处理差值表达式\n                // name {{name}} age {{age}} cc\n                // -> _v(\"name\"+_s(name)+\"age\"+_s(age)+\"cc\")\n                let tokens = [];\n                let match;\n                let index;\n                let lastIndex = defaultTagRE.lastIndex = 0;// lastIndex下次匹配的索引\n                while (match = defaultTagRE.exec(text)) {\n                    index = match.index;\n                    if (index > lastIndex) {\n                        tokens.push(JSON.stringify(text.slice(lastIndex, index)))\n                    }\n                    tokens.push(`_s(${match[1].trim()})`);\n                    lastIndex = index + match[0].length;\n                }\n                if (lastIndex < text.length) {\n                    // 最后没匹配上的也需要放进去\n                    tokens.push(JSON.stringify(text.slice(lastIndex)))\n                }\n                return `_v(${tokens.join('+')})`\n            } else {\n\n                return `_v(${JSON.stringify(text)})`;\n\n            }\n        }\n    }\n\n    if (children) {\n        return children.map(child => gen(child)).join(',')\n    }\n}\n\n/**\n * ast-> js(render)\n * @param el\n */\nexport function generate(el) {\n    // ast树 -》 js代码  语法本身的转换\n    // 转换成render代码\n    let children = genChildren(el)\n    let code = `_c(${JSON.stringify(el.tag)},${\n        el.attrs.length ? genProps(el.attrs) : 'undefined'\n    }\n        ${\n        children ? ',' + children : ''\n    }\n    )`\n    return code\n}\n\n/**\n <div id=\"app\" a=\"1\" b=\"2\">\n <span style=\"color:red\">\n {{name}}\n <a href=\"#\">hello</a>\n </span>\n </div>\n // ast -> render函数的js\n // js -> 虚拟dom\n // render函数生成的是虚拟dom\n function render() {\n    return _c(\n        'div',// tag\n        {id: 'app', a: '1', b: '2'},// 标签属性\n        _c( // 第一个children\n            'span',\n            {style: 'color:red'},\n            _s(name),// 模版字符串\n            _c('a',\n                {},\n                _v('hello')) // 文本节点\n        )\n    )\n}\n **/\n\n\n\n","import {parseHtml} from \"./parse\";\nimport {generate} from \"./generate\";\n\nexport function compileToFunction(template) {\n    // 1、template源码 -> ast语法树\n    const el = parseHtml(template)\n    // 2、 ast -> render code -> render function\n    // ast语法树 -> 包装成render函数体的字符串  _c('div',{},_c('span'))\n    let code = generate(el)\n    // 函数体字符串 ——> 包装成 --> render函数\n    let render = new Function(`\n    with(this){\n        return ${code}\n    }\n    `)\n    // 3、render function done -> virtual dom\n    return render\n    // with和eval的区别，eval不干净，会获取到外面的值\n}\n\n\n","let callbacks = []\nlet waiting = false\n\nfunction flushCallbacks() {\n    for (let cb of callbacks) {\n        cb()\n    }\n    waiting = false\n    callbacks = []\n}\n\n// 批处理，第一次开启定时器，后序只更新列表，之后执行清空逻辑\n// 第一次cb 渲染watcher更新操作会调用nextTick 渲染watcher执行的过程肯定是同步的\n// 第二次cb 用户传人nextTick的回调，\nexport function nextTick(cb) {\n    callbacks.push(cb) // 默认的cb是渲染逻辑，用户的逻辑放到渲染逻辑之后就行。\n    if (!waiting) {\n        waiting = true;\n        // vue2做降级，vue3直接用promise.then了\n        // 1、promise是否支持\n        // 2、mutationObserver\n        // 3、setImmediate\n        // 4、setTimeout\n        Promise.resolve().then(flushCallbacks)\n    }\n}\n\nexport const isObject = (val) => typeof val === 'object' && val !== null;\n// 策略\nconst LIFECYCLE_HOOKS = [\n    'beforeCreate',\n    'created',\n]\nconst strategies = {} // 策略集合\n// 钩子合并策略\nLIFECYCLE_HOOKS.forEach(hook => {\n    strategies[hook] = function mergeHooks(parentValue, childValue) {\n        if (!childValue) {\n            // 儿子没有，用父亲\n            return parentValue;\n        } else {\n            if (parentValue) {\n                // 都有\n                return parentValue.concat(childValue)\n            } else {\n                // 只有儿子\n                return [childValue]\n            }\n        }\n    }\n})\n// 其他策略\n// strategies.data = function () {\n// }\n// 组件的合并策略\nstrategies.components = function (parentValue, childValue) {\n    // 查找链\n    const res = Object.create(parentValue)\n    if (childValue) {\n        for (let key in childValue) {\n            res[key] = childValue[key]\n        }\n    }\n    return res;\n}\n\nexport function mergeOptions(parent, child) {\n    let options = {}\n    // 不同的生命周期的合并策略（策略模式）\n\n    // 普通属性的合并策略\n    // 1 如何父亲有儿子没，应该儿子替换父亲\n    // 2 如果父亲有值，用父亲的\n    for (let key in parent) {\n        mergeField(key)\n    }\n\n    for (let key in child) {\n        if (!parent.hasOwnProperty(key)) {\n            mergeField(key)\n        }\n    }\n\n    function mergeField(key) {\n        if (strategies[key]) {\n            return options[key] = strategies[key](parent[key], child[key])\n        }\n        if (isObject(parent[key]) && isObject(child[key])) {\n            options[key] = {...parent[key], ...child[key]}\n        } else {\n            if (child[key]) {\n                options[key] = child[key]\n            } else {\n                options[key] = parent[key]\n            }\n        }\n    }\n\n    return options\n}\n\nfunction makeUp(str) {\n    const map = {}\n    str.split(',').forEach(tagName => {\n        map[tagName] = true\n    })\n    return (tag) => map[tag] || false;\n}\n\nexport const isReservedTag = makeUp('a,p,div,ul,li,span,input,button')\n\n\nexport function isSameVnode(oldVnode, newVnode) {\n    return (oldVnode.tag === newVnode.tag && oldVnode.key === newVnode.key)\n}\n","import {nextTick} from \"../utils\";\n\nlet has = {}\nlet queue = []\nlet pending = false\n\nfunction flushSchedulerQueue() {\n    for (let watcher of queue) {\n        watcher.run()\n    }\n    has = {}\n    queue = []\n    pending = false\n}\n\n// 多次调用queueWatcher，可能会开启多个nextTick ，如果watcher不是同一个,\nexport function queueWatcher(watcher) {\n    // 调度更新几次\n    // 更新是对watcher进行重新操作\n    let id = watcher.id;\n    if (has[id] == null) { // 没有id\n        queue.push(watcher);\n        has[id] = true;\n        if (!pending) { // 加锁\n            pending = true\n            // 让queue清空\n            nextTick(flushSchedulerQueue)\n        }\n        // setTimeout(() => {\n        //     flushSchedulerQueue()\n        // }, 0)\n    }\n}\n","import {popTarget, pushTarget} from \"./dep\";\nimport {queueWatcher} from \"./scheduler\";\n\nlet id = 0;\n\nexport class Watcher {\n    constructor(vm, exprOrFn, cb, options) {\n        this.id = id++\n        this.vm = vm;\n        this.cb = cb;\n        this.options = options;\n        this.getter = exprOrFn\n        this.deps = [] //  如果是相同页面多个标签取get一个属性，会触发多次.\n        this.depsId = new Set() // dep去重\n        this.get()\n        // this.exprOrFn() // 调用传人的函数。调用了render方法，此时会对模版中的数据进行取值\n    }\n\n    get() {\n        pushTarget(this) // 1、将当前watcher放到Dep上， Dep.target = watcher\n        this.getter() // 2、对属性进行取值 vm._update(vm._render())\n        popTarget() // 3、清空Dep.target = null，不在模版中访问对值不记录watcher\n    }\n\n    addDep(dep) { //\n        const id = dep.id\n        // 一个dep可能对应多个watcher，\n        if (!this.depsId.has(id)) { // dep去重,watcher也驱虫了\n            this.depsId.add(id)\n            this.deps.push(dep)// 让watcher记住dep\n            dep.addSub(this) // 让dep记住watcher,唯一的dep记住唯一的watcher\n        }\n    }\n\n    update() {\n        // this.get() // 数据一变重新渲染，同一个事件环中多次更新会触发多次\n        queueWatcher(this); // 批处理，调度更新几次，\n    }\n\n    run() {\n        console.log('-------')\n        this.get()\n    }\n    // 当属性取值时要记住这个watcher，稍后数据变化了，去执行自己记住的watcher即可。依赖收集\n}\n\n\n\n","import {isSameVnode} from \"../utils\";\n\nexport function patch(oldVnode, vnode) {\n    if (!oldVnode) {\n        // 子组件渲染的时候没有oldVnode作为老组件\n        // 直接根据虚拟节点创建元素\n        return createElm(vnode)\n    }\n    // 首次渲染oldvnode是真实的dom元素\n    const isRealElement = oldVnode.nodeType;\n    if (isRealElement) {\n        // 2、首次\n        // 初次渲染\n        const oldElm = oldVnode\n        const parentElm = oldElm.parentNode;\n        // 根据虚拟节点创建真实的节点\n        let el = createElm(vnode);\n        parentElm.insertBefore(el, oldElm.nextSibling);\n        parentElm.removeChild(oldElm)\n        return el\n    } else {\n        // 3、两个虚拟节点的比对\n        // 更新 diff算法\n        // 1、如果新旧两个节点标签不一样，直接替换\n        if (oldVnode.tag !== vnode.tag) {\n            return oldVnode.el.parentNode.replaceChild(createElm(vnode), oldVnode.el)\n        }\n        // 2、标签相同但是是两个文本节点\n        if (!oldVnode.tag) {\n            if (oldVnode.text !== vnode.text) {\n                return oldVnode.el.textContent = vnode.text\n            }\n        }\n        // 3、元素相同，复用老节点，更新属性\n        let el = vnode.el = oldVnode.el; //\n        updateProperties(vnode, oldVnode.data) // 用老的属性和新的节点属性比对\n\n        // 4、标签 属性都一样了，更新儿子！！\n        let oldChildren = oldVnode.children || [];\n        let newChildren = vnode.children || [];\n        if (oldChildren.length > 0 && newChildren.length > 0) {\n            // 1) 老的新的都有儿子（diff算法）\n            updateChildren(el, oldChildren, newChildren)\n        } else if (oldChildren > 0) {\n            // 2) 老的有新的没有儿子：直接删除老儿子\n            el.innerHTML = ''\n        } else if (newChildren.length > 0) {\n            // 3) 老的没儿子新的有儿子：在老节点新增儿子即可\n            newChildren.forEach(child => {\n                el.appendChild(createElm(child))\n            })\n        }\n    }\n}\n\n\nfunction updateChildren(parent, oldChildren, newChildren) {\n    // 核心diff算法\n    // 双指针\n    let oldStartIndex = 0; // 老头索引\n    let oldEndIndex = oldChildren.length - 1; // 老尾索引\n    let oldStartVnode = oldChildren[0]; // 老开始节点\n    let oldEndVnode = oldChildren[oldEndIndex]\n\n    let newStartIndex = 0; // 新头索引\n    let newEndIndex = newChildren.length - 1; // 新尾索引\n    let newStartVnode = newChildren[0]; // 新开始节点\n    let newEndVnode = newChildren[newEndIndex]\n\n    function makeIndexByKey(oldChildren) {\n        return oldChildren.reduce((map, child, index) => {\n            if (child.key !== undefined) {\n                map[child.key] = index\n            }\n            return map\n        }, {})\n    }\n\n    let map = makeIndexByKey(oldChildren);\n    // 从头往后比\n    while (oldStartIndex <= oldEndIndex && newStartIndex <= newEndIndex) {\n        // dom的移动性，\n        // 尾部插入、头部插入、头部移动到尾部、尾部移动到头部、正序、反序\n        if (!oldStartVnode) {\n            // 空白节点直接跳过\n            oldStartVnode = oldChildren[++oldStartIndex]\n        } else if (!oldEndVnode) {\n            // 空白节点直接跳过\n            oldEndVnode = oldChildren[--oldEndIndex]\n        } else if (isSameVnode(oldStartVnode, newStartVnode)) {\n            // 1 头和头相比 尾部插入\n            patch(oldStartVnode, newStartVnode) // 递归，深度遍历\n            oldStartVnode = oldChildren[++oldStartIndex];\n            newStartVnode = newChildren[++newStartIndex];\n        } else if (isSameVnode(oldEndVnode, newEndVnode)) {\n            // 2 尾和尾比 头部插入\n            patch(oldEndVnode, newEndVnode) // 递归，深度遍历\n            oldEndVnode = oldChildren[--oldEndIndex];\n            newEndVnode = newChildren[--newEndIndex];\n        } else if (isSameVnode(oldStartVnode, newEndVnode)) {\n            // 3  老头和新尾比  将老的头部节点移动到老的尾节点后面. 头和尾交叉比,\n            patch(oldStartVnode, newEndVnode)\n            parent.insertBefore(oldStartVnode.el, oldEndVnode.el.nextSibling)\n            oldStartVnode = oldChildren[++oldStartIndex];\n            newEndVnode = newChildren[--newEndIndex];\n        } else if (isSameVnode(oldEndVnode, newStartVnode)) {\n            // 4 老尾和新头比  将老的尾部节点移动到老的头节点前面, 头和尾交叉比，\n            patch(oldEndVnode, newStartVnode)\n            parent.insertBefore(oldEndVnode.el, oldStartVnode.el)\n            oldEndVnode = oldChildren[--oldEndIndex];\n            newStartVnode = newChildren[++newStartIndex];\n        } else {\n            // 5 乱序\n            // 需要先查找当前 老节点索引和key的关系\n            // 移动的时候通过新的key，去找对应的老节点索引 --》 获取老节点，可以移动老节点\n            let moveIndex = map[newStartVnode.key]\n            if (moveIndex === undefined) { // 判断新的儿子在老儿子里有没有对应的key\n                parent.insertBefore(createElm(newStartVnode), oldStartVnode.el)\n            } else {\n                let moveVnode = oldChildren[moveIndex]\n                oldChildren[moveIndex] = undefined;\n                patch(moveVnode, newStartVnode) // 如果找到了 再对两者的进行深层比对\n                parent.insertBefore(moveVnode.el, oldStartVnode.el)\n            }\n            newStartVnode = newChildren[++newStartIndex]\n        }\n\n        // 为什么v-for要增加key？为啥不能用index\n\n    }\n    if (newStartIndex <= newEndIndex) { // 新到比老到多，插入新节点\n        for (let i = newStartIndex; i <= newEndIndex; i++) {\n            // 像前插入或者向后插入\n            // 看一下后面又没下一个节点，有的话向前插入\n            let nextEle = newChildren[newEndIndex + 1] == null ? null : newChildren[newEndIndex + 1].el\n            // appendChild 和 insertBefore 也可以进行合并\n            // 如果insertBefore 传入null 等价于appendChild\n            parent.insertBefore(createElm(newChildren[i]), nextEle)\n        }\n    }\n    if (oldStartIndex <= oldEndIndex) {\n        for (let i = oldStartIndex; i <= oldEndIndex; i++) {\n            let child = oldChildren[i]\n            if (child !== undefined) {\n                parent.removeChild(child.el)\n            }\n        }\n    }\n\n}\n\n// vnode -》真实dom\nexport function createElm(vnode) {\n    let {tag, children, key, data, text, vm} = vnode;\n    if (typeof tag === 'string') {// 组件或者原生标签\n        //  如果是组件\n        if (createComponent(vnode)) {\n            return vnode.componentInstance.$el\n        }\n        vnode.el = document.createElement(tag) //\n        updateProperties(vnode)\n        children.forEach(child => {\n            // 有可能是文本\n            vnode.el.appendChild(createElm(child))\n        })\n    } else {\n        vnode.el = document.createTextNode(text)\n    }\n    return vnode.el;\n}\n\n// 创建组件\nfunction createComponent(vnode) {\n    let i = vnode.data;\n    if ((i = i.hook) && (i = i.init)) { // 连续取值\n        i(vnode) // init回调，会想vnode增加componentInstance属性\n    }\n    if (vnode.componentInstance) {\n        return true\n    }\n}\n\n// 更新属性\nfunction updateProperties(vnode, oldProps = {}) {\n    let newProps = vnode.data || {}; // 属性\n    let el = vnode.el; // dom元素\n    // 1、老的有,新的没：删除\n    for (let key in oldProps) {\n        if (!newProps[key]) {\n            el.removeAttribute(key) // 新版浏览器会有个批处理，多次修改会合并。\n        }\n    }\n    // style需要特殊判断\n    let newStyle = newProps.style || {};\n    let oldStyle = oldProps.style || {};\n    for (let key in oldStyle) {\n        if (!newStyle[key]) {\n            el.style[key] = ''\n        }\n    }\n\n    // 2、新的有老的没：新增\n    // 3、老的新的都有直接覆盖\n    for (let key in newProps) {\n        if (key === 'style') {\n            for (let styleKey in newProps.style) {\n                el.style[styleKey] = newProps.style[styleKey]\n            }\n        } else if (key === 'class') {\n            el.className = newProps.class\n        } else {\n            el.setAttribute(key, newProps[key])\n        }\n    }\n}\n","import {Watcher} from \"./observer/watcher\";\nimport {patch} from \"./vdom/patch\";\n\nexport function lifecycleMixin(Vue) {\n    Vue.prototype._update = function (vnode) {\n        // 将虚拟节点转换成真实dom\n        const vm = this;\n        // 首次渲染 需要用虚拟节点，来更新真实的dom元素\n        // vm.$el = patch(vm.$options.el, vnode)\n        // 第一次渲染完毕后，拿到新的节点，下次更新再次渲染时替换上次渲染的结果\n\n        // 第一次初始化 第二次diff算法\n        const preVnode = vm._vnode // 取上次vnode\n        vm._vnode = vnode;\n        if (!preVnode) {\n            vm.$el = patch(vm.$el, vnode) // 组件渲染时调用patch方法会产生$el属性\n        } else {\n            vm.$el = patch(preVnode, vnode) // 第二次 diff算法\n        }\n    }\n}\n\nexport function callHook(vm, hook) { // 发布模式\n    const handlers = vm.$options[hook]\n    if (handlers) {\n        handlers.forEach(handler => handler.call(vm))\n    }\n}\n\nexport function mountComponent(vm) {\n    // 默认vue是通过watcher来渲染的，渲染watcher 每一个组件都有一个渲染watcher\n    function updateComponent() {\n        vm._update(vm._render(vm)); //  vm._render()获取虚拟节点（虚拟dom） _update把虚拟节点变成真实节点\n    }\n\n    // 其实就是执行updateComponent, 不过需要创建一个渲染watcher, 将watcher放到Dep.target上, 然后进行取值；最后清空Dep.target\n    new Watcher(vm, updateComponent, () => {\n    }, true)\n}\n\n","import {initState} from \"./state\";\nimport {compileToFunction} from \"./compiler/index\";\nimport {callHook, mountComponent} from \"./lifecycle\";\nimport {mergeOptions, nextTick} from \"./utils\";\n\nexport default function initMixin(Vue) {\n    Vue.prototype._init = function (options) { // 这个options是用户传人的配置\n        const vm = this\n        // 初始化状态\n        // 合并选项 vm.constructor代表的是当前实例的构造函数\n        vm.$options = mergeOptions(vm.constructor.options, options)\n        // vm.$options = options;\n        callHook(vm, 'beforeCreate') // 增加钩子，发布\n        initState(vm);//\n        callHook(vm, 'created') // 增加钩子，帆布\n\n\n        if (vm.$options.el) { // 判断是否有el直接挂载\n            vm.$mount(vm.$options.el)\n        }\n    }\n    Vue.prototype.$nextTick = nextTick\n    Vue.prototype.$mount = function (el) {\n        el = el && document.querySelector(el)\n        const vm = this;\n        const options = vm.$options;\n        vm.$el = el;\n        // 如果有render直接使用\n        // 没有render， 看有没有template属性\n        // 没有template，找外部模版\n        if (!options.render) {\n            let template = options.template\n            if (!template && el) {\n                template = el.outerHTML // 火狐不兼容\n                // template = document.createElement('div').appendChild(el).innerHTML\n            }\n            // 拿到html模版,如何将模版编译成render函数\n            // html template -> render函数\n            const render = compileToFunction(template)\n            options.render = render;\n        }\n        mountComponent(vm) // 组件挂载\n\n    }\n}\n\n\n\n","import {isObject, isReservedTag} from \"../utils\";\n\nexport function createElement(vm, tag, data = {}, ...children) {\n    // 需要区分原生标签和自定义标签（组件）\n    // console.log(tag,isReservedTag(tag))\n    if (isReservedTag(tag)) {\n        return Vnode(vm, tag, data, data.key, children, undefined)\n    } else {\n        // 不是一个普通标签，就是组件了\n        const Ctor = vm.$options.components[tag] // 内部创建的组件是对象，外部创建的是函数\n        // return {text:1234}\n        return createComponentVnode(vm, tag, data, data.key, children, Ctor)\n        // tag可能是对象？\n    }\n}\n\nexport function createComponentVnode(vm, tag, data, key, children, Ctor) {\n    if (isObject(Ctor)) {\n        // 将对象转成函数,组件的核心就是.extend\n        // 组件的构造函数\n        Ctor = vm.$options._base.extend(Ctor)\n    }\n    // 给组件增加生命周期\n    data.hook = {\n        init(vnode) {\n            // 初始化的钩子\n            // 调用子组件的构造函数,获取子组件实例\n            let child = vnode.componentInstance = new vnode.componentOptions.Ctor({})\n            child.$mount() // 子组件手动挂载 child.$el == vnode.componentInstance.$el == 真实元素\n        }\n    }\n    // 组件的虚拟节点拥有hook和当前组件的componentOptions中存放了组件的构造函数\n    return Vnode(vm, `vue-component-${Ctor.cid}-${tag}`, data, key, undefined, undefined, {Ctor});\n\n}\n\nexport function createTextVnode(vm, text) {\n    return Vnode(vm, undefined, undefined, undefined, undefined, text)\n}\n\nfunction Vnode(vm, tag, data, key, children, text, componentOptions) {\n    return {\n        vm,\n        tag,\n        data,\n        key,\n        text,\n        children,\n        componentOptions\n    }\n}\n","import {createElement, createTextVnode} from \"./vdom/index\";\n\nexport function renderMixin(Vue) {\n    Vue.prototype._c = function (...args) {\n        // 创建元素的虚拟节点\n        return createElement(this, ...args)\n    }\n    Vue.prototype._v = function (text) {\n        // 创建文本的虚拟节点\n        return createTextVnode(this, text)\n\n    }\n    Vue.prototype._s = function (val) {\n        // 转换成字符串\n        return (val === null ? \"\" :\n            (typeof val === 'object') ? JSON.stringify(val) :\n                val)\n    }\n    // 产生虚拟dom\n    Vue.prototype._render = function () {\n        const vm = this;\n        let render = vm.$options.render;\n        // 调用render方法产生虚拟节点\n        let vnode = render.call(vm); // _c(xx,xx,xx) 调用是会自动将变量进行取值，将其结果进行渲染\n        return vnode;\n    }\n}\n","import {mergeOptions} from \"../utils\";\n\nexport function initGlobalAPI(Vue) {\n    Vue.options = {} // 存储全局配置\n    // filter directive component\n    Vue.mixin = function (mixin) {\n        this.options = mergeOptions(this.options, mixin)\n        console.log(this.options)\n        return this;\n    }\n    Vue.options._base = Vue;// 永远执行Vue的构造函数\n    Vue.options.components = {}; // 内部的局部组件\n    Vue.component = function (id, definition) {\n        definition.name = definition.name || id // 组件的名字先采用对象内写的\n\n        // 通过一个对象产生一个构造函数, 保证永远使用的是Vue的extend,\n        // 不管谁调component, 最后extend中返回的子类都是继承自原始的Vue。this.options._base永远指向Vue\n        definition = this.options._base.extend(definition)\n        // definition = Vue.extend(definition)\n        this.options.components[id] = definition;\n    }\n    let cid = 0\n    Vue.extend = function (options) {\n        const Super = this;\n        // 子组件初始化时会 new VueComponent(options)\n        const Sub = function VueComponent(options) {\n            this._init(options)\n        }\n        Sub.cid = cid++\n        // 子类继承父类\n        // 继承原型方法，所有组件 不管是子类还是孙子类都继承自原始的Vue\n        Sub.prototype = Object.create(Super.prototype)\n        Sub.prototype.constructor = Sub;\n        Sub.component = Super.component;\n        // 子类的options\n        Sub.options = mergeOptions(Super.options, options)\n        return Sub\n    }\n    // Sub.component()\n}\n\n","// vue2 options API 无法tree-shaking\n// vue2中就是一个构造函数 class不好用mixin增加属性\nimport initMixin from \"./init\";\nimport {lifecycleMixin} from \"./lifecycle\";\nimport {renderMixin} from \"./render\";\nimport {initGlobalAPI} from \"./global-api/index\";\n\nfunction Vue(options) {\n    this._init(options);\n}\n\n// // 可以拆分逻辑到不同的文件中 更利于代码维护 模块化的概念\n// Vue.prototype._init = function () {\n// }\ninitMixin(Vue)\nlifecycleMixin(Vue)\nrenderMixin(Vue)\ninitGlobalAPI(Vue)\n\nlet vm1 = new Vue({name:'zf'})\nexport default Vue;\n\n","import Vue from './index.js'\nimport {compileToFunction} from \"./compiler/index\";\nimport {createElm, patch} from \"./vdom/patch\";\n// diff算法\n// 我们自己构建两个虚拟dom，之后手动比对\n(function (done) {\n    if (!done) return\n    // 1、不进行diff操作的 之前的操作，先删除原来的，在创建新的\n    let vm1 = new Vue({\n        data() {\n            return {\n                name: 'wby1',\n                age: 16\n            }\n        }\n    })\n    let render1 = compileToFunction(`<div><div>{{name}}</div><div>{{age}}</div></div>`)\n    let oldVnode = render1.call(vm1)\n    let el1 = createElm(oldVnode) //\n    document.body.appendChild(el1)\n    let vm2 = new Vue({\n        data() {\n            return {\n                name: 'wby22',\n                age: 16\n            }\n        }\n    })\n    let render2 = compileToFunction(`<div><div>{{name}}</div><div>{{age}}</div></div>`)\n    let newVnode = render2.call(vm2)\n    let el2 = createElm(newVnode) //\n    document.body.removeChild(el1)\n    document.body.appendChild(el2)\n})();\n(function (done) {\n    if (!done) return\n    let vm1 = new Vue({\n        data() {\n            return {\n                name: 'wby1',\n                age: 16\n            }\n        }\n    })\n    let oldVnode = compileToFunction(`<div a=\"1\" style=\"background:red;color:white\">{{name}}</div>`).call(vm1)\n    let el1 = createElm(oldVnode)\n    document.body.appendChild(el1)\n\n    let vm2 = new Vue({\n        data() {\n            return {\n                name: 'wby22',\n                age: 16\n            }\n        }\n    })\n    // 1、 标签不一样，div -> p\n    let render2 = compileToFunction(`<p>{{name}}</p>`)\n    let newVnode2 = render2.call(vm2)\n    // patch(oldVnode, newVnode2)\n    // 2、标签一样，更新属性\n    let render3 = compileToFunction(`<div b=\"2\" style=\"color:green\">{{name}}</div>`)\n    let newVnode3 = render3.call(vm2)\n    setTimeout(() => {\n        patch(oldVnode, newVnode3)\n    }, 1000)\n})();\n(function (done) {\n    if (!done) return\n    let vm1 = new Vue({\n        data() {\n            return {}\n        }\n    })\n    let oldVnode = compileToFunction(`\n        <ul>\n            <li key=\"A\" style=\"background:red\">A</li>\n            <li key=\"B\" style=\"background:yellow\">B</li>\n            <li key=\"C\" style=\"background:blue\">C</li>\n            <li key=\"D\" style=\"background:green\">D</li>\n            <li key=\"F\" style=\"background:pink\">F</li>\n        </ul>`).call(vm1)\n    let el1 = createElm(oldVnode)\n    document.body.appendChild(el1)\n    let vm2 = new Vue({\n        data() {\n            return {}\n        }\n    })\n    // 2、标签一样，都有儿子，diff\n    let render3 = compileToFunction(`\n        <ul>\n             <li key=\"N\" style=\"background:pink\">N</li>\n             <li key=\"A\" style=\"background:red\">A</li>\n             <li key=\"C\" style=\"background:blue\">C</li>\n             <li key=\"B\" style=\"background:yellow\">B</li>\n            <li key=\"E\" style=\"background:purple\">E</li>\n        </ul>`)\n    let newVnode3 = render3.call(vm2)\n    setTimeout(() => {\n        console.log('------------')\n        patch(oldVnode, newVnode3)\n    }, 1000)\n})(11);\n\nexport default Vue\n"],"names":["oldArrayProtoMethod","Array","prototype","arrayMethods","Object","create","methods","forEach","_method","console","log","args","result","call","inserted","__obj__","__ob__","slice","observeArray","dep","notify","id","Dep","subs","target","addDep","watcher","push","update","pushTarget","popTarget","Observer","value","defineProperty","enumerable","configurable","isArray","setPrototypeOf","walk","item","observer","data","keys","key","defineReactive","dependArray","depend","childObj","get","set","newValue","initState","vm","opts","$options","props","initData","proxy","source","_data","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHtml","html","root","currentParent","stack","createASTElement","tag","attrs","type","children","parent","start","tagName","element","end","pop","length","chars","text","replace","advance","n","substring","parseStartTag","match","attr","name","textEnd","indexOf","startTagMatch","endTagMatch","defaultTagRE","genProps","str","split","reduce","p","v","JSON","stringify","genChildren","el","gen","node","generate","tokens","index","lastIndex","exec","trim","join","map","child","code","compileToFunction","template","render","Function","callbacks","waiting","flushCallbacks","cb","nextTick","Promise","resolve","then","isObject","val","LIFECYCLE_HOOKS","strategies","hook","mergeHooks","parentValue","childValue","concat","components","res","mergeOptions","options","mergeField","hasOwnProperty","makeUp","isReservedTag","isSameVnode","oldVnode","newVnode","has","queue","pending","flushSchedulerQueue","run","queueWatcher","Watcher","exprOrFn","getter","deps","depsId","Set","add","addSub","patch","vnode","createElm","isRealElement","nodeType","oldElm","parentElm","parentNode","insertBefore","nextSibling","removeChild","replaceChild","textContent","updateProperties","oldChildren","newChildren","updateChildren","innerHTML","appendChild","oldStartIndex","oldEndIndex","oldStartVnode","oldEndVnode","newStartIndex","newEndIndex","newStartVnode","newEndVnode","makeIndexByKey","undefined","moveIndex","moveVnode","i","nextEle","createComponent","componentInstance","$el","document","createElement","createTextNode","init","oldProps","newProps","removeAttribute","newStyle","style","oldStyle","styleKey","className","setAttribute","lifecycleMixin","Vue","_update","preVnode","_vnode","callHook","handlers","handler","mountComponent","updateComponent","_render","initMixin","_init","constructor","$mount","$nextTick","querySelector","outerHTML","Vnode","Ctor","createComponentVnode","_base","extend","componentOptions","cid","createTextVnode","renderMixin","_c","_v","_s","initGlobalAPI","mixin","component","definition","Super","Sub","VueComponent","done","vm1","age","render1","el1","body","vm2","render2","el2","render3","newVnode3","setTimeout"],"mappings":"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"}